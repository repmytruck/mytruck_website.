<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--titulo-->
    <title>Adicione seu Food Truck</title>
    <!--icone-->
    <link rel="icon" type="imagem/png" href="Favicon.ico" />
   <!--bootstrap-->

	<script src="js/jquery-3.3.1.min.js"></script>
    <script src="css/bootstrap-4.1.1/js/bootstrap.min.js"></script>   
    	<!--fontawesome-free-5.0.13-->
	<link rel="stylesheet" href="../css/font-awesome/css/fontawesome-all.min.css">
    <!--animações-->
    <link rel="stylesheet" type="text/css" href="../css/animate.css">
    <!--css-->
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <!--AngularJS v1.6.9-->
    <script src="../js/angular.min.js"></script> 
    
         <!-- all css here -->
         <link rel="stylesheet" href="assets/css/bootstrap.min.css">

         <link rel="stylesheet" href="assets/css/icofont.css">
         <link rel="stylesheet" href="assets/css/meanmenu.min.css">
         <link rel="stylesheet" href="assets/css/slick.css">
         <link rel="stylesheet" href="assets/css/owl.carousel.css">
         <link rel="stylesheet" href="assets/css/magnific-popup.css">
         <link rel="stylesheet" href="assets/css/shortcode/shortcodes.css">
         <link rel="stylesheet" href="assets/style.css">
         <link rel="stylesheet" href="assets/css/responsive.css">

    <!--css login/cadastro-->
    <style>
        body{background-color: #E9E9E9;}
        #mostrarlogado{display:none;}
        .btn{margin: 30px 0 20px 0;}
        #caixa, .avisocaixa {background-color: #fff; margin: 8px; padding:30px;}
        #formparknao{display: none;}
        #formparkcadastro{display: none;}
        #listaparks input[type=radio]{display:none;} 
        #listaparks input[type=radio] + label {transition: background-color 1s; cursor: pointer; width:100%; border:thin solid #ccc;} 
        #listaparks input[type=radio]:checked + label {background-color:#ccc;} 
        #mensagemErro{font-size:16px; text-align:center;color:brown;}
        
        @media only screen and (max-width: 900px) {
            #avisocaixa{margin-top:8px !important;}
        }
    </style>
</head>

<body ng-app="" class="animated fadeIn">

    <!--header-->
    <ng-include src="'../partes/header.html'"></ng-include>

    <!--aviso deslogado-->
    <div class="container" id="avisocaixa">
        <div class="row centered" id="avisodeslogado"></div>
    </div>


    <div class="container" id="mostrarlogado">

        <div class="row centered">
            <div class="col-md-2"></div> 
            

            <!--caixa formulário-->
            <div class="col-md-8 shadow" id="caixa">
                <!--titulo e subtitulo-->
                <div class="text-center">
                <h1>Cadastre seu Food Truck</h1>
                <span>Os campos obrigatórios estão marcados com (*) <br>Você pode adicionar o cardapio e editar essas informações depois...</span><br><br>
                </div>
            

                <!--formulario-->
                <form id="formulario" >

                    <div class="form-group">
                        <label for="nomeTruck">Nome do seu Food Truck*</label>
                        <input type="text" class="form-control" id="nomeTruck" autofocus>
                    </div>

                    <div class="form-group">
                        <label for="descTruck">Descrição(slogan) do seu Food Truck*</label>
                        <textarea class="form-control" id="descTruck" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="fotoTruck">Foto do Food Truck*</label>
                        <input type="file" class="form-control-file"  accept="image/*" id="fotoTruck">
                    </div>

                    <div class="row">
                    <div class="form-group col-md-6">
                        <label for="cnpjTruck">CNPJ*</label>
                        <input type="text" class="form-control" id="cnpjTruck" placeholder="00.000.000/0000-00" onkeyup="mascara('##.###.###/####-##',this,event,true)" maxlength="18">
                    </div>

                    <div class="form-group col-md-6">
                        <label for="truckTel">Telefone (opcional)</label>
                        <input type="tel" class="form-control" id="truckTel" onkeyup="mascara('(##) #########',this,event,true)" maxlength="14">
                    </div>

                    </div>

               
                    <hr><hr>
                    <div class="form-group" style="background-color: #E9E9E9;padding:15px;">
                        <label for="parkTruck">Seu Food Truck está em um Food Park atualmente?*</label><br>
                        <input id="condparknao" class="radio-inline" type="radio" name="parkTruck" value="nao" >
                        <label for="condparknao">Não</label>
                        <input id="condparksim" class="radio-inline" type="radio" name="parkTruck" value="sim" checked>
                        <label for="condparksim">Sim</label>
                    </div>
                    <hr><hr>
                

                    <!--condicional não-->
                    <div id="formparknao">
                                         
                        <!--endereço truck-->
                        <div class="row">
                        <div class="form-group col-sm-4">
                            <label for="cepTruck">CEP*</label>
                            <input type="text" class="form-control form-control-sm" id="cepTruck" value=""  onkeyup="mascara('#####-###',this,event,true)" maxlength="9" onblur="pesquisacepTruck(this.value);">
                            <div id="mensagemCepTruck"></div>
                        </div>
                        <div class="form-group col-sm-2">
                            <label for="numeroTruck">Número*</label>
                            <input type="number" class="form-control form-control-sm" id="numeroTruck" onblur="pesquisacepTruck(cepTruck.value);">
                        </div>
                        <div class="form-group col-sm-6">
                            <label for="complementoTruck">Complemento(opcional)</label>
                            <input type="text" class="form-control form-control-sm" id="complementoTruck" onblur="pesquisacepTruck(cepTruck.value);">
                        </div>
                        </div>
                        <div class="row">
                        <div class="form-group col-sm-12">
                            <label for="localTruck">Endereço</label>
                            <input type="text" class="form-control form-control-sm" id="localTruck" disabled>
                        </div>
                        <div class="form-group col-sm-12">
                            <input type="text" class="form-control form-control-sm" id="localMapsTruck" style="display: none !important;" disabled>
                        </div>
                        </div>
                        <!--fim endereço truck-->

                        <hr><hr>
                        <div class="row">
                            <div class="col-md-2"></div>   
                        <div class="col-md-8 text-center">

                            <h5>Funcionamento</h5>
                            <div id="semanaTruck"> 
                                    <input id="seg" class="radio-inline" type="checkbox" value="Segunda" name="semanaTruck">
                                    <label for="seg">Seg</label>
                                    <input id="ter" class="radio-inline" type="checkbox" value="Terça" name="semanaTruck">
                                    <label for="ter">Ter</label>
                                    <input id="qua" class="radio-inline" type="checkbox" value="Quarta" name="semanaTruck">
                                    <label for="qua">Qua</label>
                                    <input id="qui" class="radio-inline" type="checkbox" value="Quinta" name="semanaTruck">
                                    <label for="qui">Qui</label> 
                                    <input id="sex" class="radio-inline" type="checkbox" value="Sexta" name="semanaTruck"> 
                                    <label for="sex">Sex</label>
                                    <input id="sab" class="radio-inline" type="checkbox" value="Sabado" name="semanaTruck">
                                    <label for="sab">Sab</label>
                                    <input id="dom" class="radio-inline" type="checkbox" value="Domingo" name="semanaTruck">
                                    <label for="dom">Dom</label>
                            </div>

                        </div>
                        </div><br>

                        <div class="row">
                            <div class="col-md-3"></div>
 
                        <div class="form-group col-sm-3 text-center">
                            <label for="horaTruckabre">Abre às:*</label>
                            <input type="time" class="form-control" id="horaTruckabre">
                        </div>
                        <div class="form-group col-sm-3 text-center">
                            <label for="horaTruckfecha">Fecha às:*</label>
                            <input type="time" class="form-control" id="horaTruckfecha">
                        
                        </div>
                        </div>
                    </div><!--fim não-->

                    <!--condicional sim (exibindo parks cadastrados)-->
                    <div id="formparksim">
                        <div id="divlistaparks">
                            <h4>Food Parks</h4>
                            <div id="listaparks"></div>
                            <input id="condparkcadastro" class="radio-inline" type="checkbox" name="condparkcadastro" value="true" >
                            <label for="condparkcadastro">O food park não esta na lista</label>
                        </div>
                    <!--condicional park nao cadastrado-->
                        <div id="formparkcadastro">
                           
                            <h4>Cadastre o Food Park</h4>

                        <div class="form-group">
                            <label for="nomePark">Nome do Food Park*</label>
                            <input type="text" class="form-control" id="nomePark" autofocus>
                        </div>

                        <div class="form-group">
                            <label for="descPark">Descrição (slogan) do Food Park*</label>
                            <textarea class="form-control" id="descPark" rows="3"></textarea>
                        </div>

                        <hr>
                        <div class="row centered">
                            <div class="form-group col-md-6">
                                <label for="parkTel">Telefone (opcional)</label>
                                <input type="tel" class="form-control" id="parkTel" onkeyup="mascara('(##) #########',this,event,true)" maxlength="14">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="fotoPark">Foto do Food Park*</label>
                                <input type="file" class="form-control-file"  accept="image/*" id="fotoPark">
                            </div>
                        </div>
                        <hr>

                        <div class="row centered">
                            <div class="form-group col-md-6">
                                <label for="estacPark">Possui estacionamento?*</label><br>
                                <input type="radio" id="estacParknao" class="radio-inline" name="estacPark" value="não" checked>
                                <label for="estacParknao">Não</label>
                                <input type="radio" id="estacParksim" class="radio-inline" name="estacPark" value="sim">
                                <label for="estacParksim">Sim</label>
                            </div>

                            <div class="form-group col-md-6">
                                <label for="kids">Possui área para crianças?*</label><br>
                                <input type="radio" id="kidsnao" class="radio-inline" name="kids" value="não" checked>
                                <label for="kidsnao">Não</label>
                                <input type="radio" id="kidssim" class="radio-inline" name="kids" value="sim">
                                <label for="kidssim">Sim</label>
                            </div>
                        </div>
                        <hr>

                        <!--endereço park-->
                        <div class="row">
                        <div class="form-group col-sm-4">
                            <label for="cepPark">CEP*</label>
                            <input type="text" class="form-control form-control-sm" id="cepPark" value=""  onkeyup="mascara('#####-###',this,event,true)" maxlength="9" onblur="pesquisacepPark(this.value);">
                            <div id="mensagemCepPark"></div>
                        </div>
                        <div class="form-group col-sm-2">
                            <label for="numeroPark">Número*</label>
                            <input type="number" class="form-control form-control-sm" id="numeroPark" onblur="pesquisacepPark(cepPark.value);">
                        </div>
                        <div class="form-group col-sm-6">
                            <label for="complementoPark">Complemento(opcional)</label>
                            <input type="text" class="form-control form-control-sm" id="complementoPark" onblur="pesquisacepPark(cepPark.value);">
                        </div>
                        </div>
                        <div class="row">
                        <div class="form-group col-sm-12">
                            <label for="localPark">Endereço</label>
                            <input type="text" class="form-control form-control-sm" id="localPark" disabled>
                        </div>
                        <div class="form-group col-sm-12">
                            <input type="text" class="form-control form-control-sm" id="localMapsPark" style="display: none !important;" disabled>
                        </div>
                        </div>    
                        <!--fim endereço park-->
    

                        <hr>
                        <div class="row">
                            <div class="col-md-2"></div>   
                            <div class="col-md-8 text-center">

                                <h5>Funcionamento</h5>
                                <div id="semanaPark">
                                <input id="segPark" class="radio-inline" type="checkbox" value="Segunda" name="semanaPark">
                                <label for="segPark">Seg</label>
                                <input id="terPark" class="radio-inline" type="checkbox" value="Terça" name="semanaPark">
                                <label for="terPark">Ter</label>
                                <input id="quaPark" class="radio-inline" type="checkbox" value="Quarta" name="semanaPark">
                                <label for="quaPark">Qua</label>
                                <input id="quiPark" class="radio-inline" type="checkbox" value="Quinta" name="semanaPark">
                                <label for="quiPark">Qui</label> 
                                <input id="sexPark" class="radio-inline" type="checkbox" value="Sexta" name="semanaPark"> 
                                <label for="sexPark">Sex</label>
                                <input id="sabPark" class="radio-inline" type="checkbox" value="Sabado" name="semanaPark">
                                <label for="sabPark">Sab</label>
                                <input id="domPark" class="radio-inline" type="checkbox" value="Domingo" name="semanaPark">
                                <label for="domPark">Dom</label>
                                </div>

                            </div>
                        </div><br>

                            <div class="row">
                                <div class="col-md-3"></div>
    
                            <div class="form-group col-sm-3 text-center">
                                <label for="horaParkabre">Abre às:*</label>
                                <input type="time" class="form-control" id="horaParkabre">
                            </div>
                            <div class="form-group col-sm-3 text-center">
                                <label for="horaParkfecha">Fecha às:*</label>
                                <input type="time" class="form-control" id="horaParkfecha">
                            </div>

                            </div>

                        </div><!--fim formparkcadastro-->
                    </div><!--fim condicional sim-->

                    <!--mensagem de erro-->
                    <div id="mensagemErro"></div>

                    <button type="submit" class="btn btn-danger btn-block btn-lg">ENVIAR</button>
                </form>
           
                <a href="index.html">&larr; Página inicial</a><br>
                <br>
            
            </div>


        </div>
    </div>
   
<!--footer-->
<ng-include src="'../partes/footer.html'"></ng-include>

    <!-- all js here -->
    <script src="assets/js/vendor/jquery-1.12.4.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/slick.min.js"></script>
    <script src="assets/js/jquery.ajaxchimp.min.js"></script>
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/main.js"></script>


<!--script de macaras-->
<script src="js/mascaras.js"></script> 
<!--funçoes do firebase-->
<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
<!--conexão com o firebase-->
<script src="js/app.js"></script>

<script>

//##############################################################
//viacep
function limpa_formulário_cepTruck() {
    //Limpa valores do formulário de cep.
    document.getElementById('cepTruck').value=("");
    document.getElementById('numeroTruck').value=("");
    document.getElementById('complementoTruck').value=("");
    document.getElementById('localTruck').value=("");
    document.getElementById('localMapsTruck').value=("");
    mensagemCepTruck.innerHTML = '';
    document.getElementById('cepTruck').style.border = "";
}

function meu_callbackTruck(conteudo) {
if (!("erro" in conteudo)) {
    //Atualiza os campos com os valores.
    var ruaTruck = (conteudo.logradouro);
    var bairroTruck = (conteudo.bairro);
    var cidadeTruck = (conteudo.localidade);
    var ufTruck = (conteudo.uf);

    var complementoTruck = document.getElementById('complementoTruck').value;
    var numeroTruck = document.getElementById('numeroTruck').value;
    document.getElementById('localMapsTruck').value = (ruaTruck+'+'+numeroTruck+'+'+bairroTruck+'+'+cidadeTruck+'+'+ufTruck);
    document.getElementById('localTruck').value = (ruaTruck+', '+numeroTruck+' '+complementoTruck+'- '+bairroTruck+', '+cidadeTruck+'/'+ufTruck);

} //end if.
else {
    //CEP não Encontrado.
    limpa_formulário_cepTruck();
    document.getElementById('cepTruck').style.border = "thin solid red";
    mensagemCepTruck.innerHTML = ('<span class="animated flash" style="color:red; font-size:10px;">CEP não encontrado!</span>');
}}

function pesquisacepTruck(valor) {
//Nova variável "cep" somente com dígitos.
var cepTruck = valor.replace(/\D/g, '');
//Verifica se campo cep possui valor informado.
if (cepTruck != "") {
    //Expressão regular para validar o CEP.
    var validacepTruck = /^[0-9]{8}$/;
    //Valida o formato do CEP.
    if(validacepTruck.test(cepTruck)) {
        mensagemCepTruck.innerHTML = '';
        //Cria um elemento javascript.
        var script = document.createElement('script');
        //Sincroniza com o callback.
        script.src = 'https://viacep.com.br/ws/'+ cepTruck + '/json/?callback=meu_callbackTruck';
        //Insere script no documento e carrega o conteúdo.
        document.body.appendChild(script);
    } //end if.
    else {
        //cep é inválido.
        limpa_formulário_cepTruck();
        document.getElementById('cepTruck').style.border = "thin solid red";
        mensagemCepTruck.innerHTML = ('<span class="animated flash" style="color:red; font-size:10px;">Formato de CEP invalido!</span>');
    }
} //end if.
else {
    //cep sem valor, limpa formulário.
    limpa_formulário_cepTruck();
    document.getElementById('cepTruck').style.border = "thin solid red";
    mensagemCepTruck.innerHTML = ('<span class="animated flash" style="color:red; font-size:10px;">Digite primeiro o CEP!</span>');
}};//fim viacep food truck
//#######################################################
//##############################################################
//viacep food park
function limpa_formulário_cepPark() {
    //Limpa valores do formulário de cep.
    document.getElementById('cepPark').value=("");
    document.getElementById('numeroPark').value=("");
    document.getElementById('complementoPark').value=("");
    document.getElementById('localPark').value=("");
    document.getElementById('localMapsPark').value=("");
    mensagemCepPark.innerHTML = '';
    document.getElementById('cepPark').style.border = "";
}

function meu_callbackPark(conteudo) {
if (!("erro" in conteudo)) {
    //Atualiza os campos com os valores.
    var ruaPark = (conteudo.logradouro);
    var bairroPark = (conteudo.bairro);
    var cidadePark = (conteudo.localidade);
    var ufPark = (conteudo.uf);

    var complementoPark = document.getElementById('complementoPark').value;
    var numeroPark = document.getElementById('numeroPark').value;
    document.getElementById('localMapsPark').value = (ruaPark+'+'+numeroPark+'+'+bairroPark+'+'+cidadePark+'+'+ufPark);
    document.getElementById('localPark').value = (ruaPark+', '+numeroPark+' '+complementoPark+'- '+bairroPark+', '+cidadePark+'/'+ufPark);

} //end if.
else {
    //CEP não Encontrado.
    limpa_formulário_cepPark();
    document.getElementById('cepPark').style.border = "thin solid red";
    mensagemCepPark.innerHTML = ('<span class="animated flash" style="color:red; font-size:10px;">CEP não encontrado!</span>');
}}

function pesquisacepPark(valor) {
//Nova variável "cep" somente com dígitos.
var cepPark = valor.replace(/\D/g, '');
//Verifica se campo cep possui valor informado.
if (cepPark != "") {
    //Expressão regular para validar o CEP.
    var validacepPark = /^[0-9]{8}$/;
    //Valida o formato do CEP.
    if(validacepPark.test(cepPark)) {
        mensagemCepPark.innerHTML = '';
        //Cria um elemento javascript.
        var script = document.createElement('script');
        //Sincroniza com o callback.
        script.src = 'https://viacep.com.br/ws/'+ cepPark + '/json/?callback=meu_callbackPark';
        //Insere script no documento e carrega o conteúdo.
        document.body.appendChild(script);
    } //end if.
    else {
        //cep é inválido.
        limpa_formulário_cepPark();
        document.getElementById('cepPark').style.border = "thin solid red";
        mensagemCepPark.innerHTML = ('<span class="animated flash" style="color:red; font-size:10px;">Formato de CEP invalido!</span>');
    }
} //end if.
else {
    //cep sem valor, limpa formulário.
    limpa_formulário_cepPark();
    document.getElementById('cepPark').style.border = "thin solid red";
    mensagemCepPark.innerHTML = ('<span class="animated flash" style="color:red; font-size:10px;">Digite primeiro o CEP!</span>');
}};
//fim viacep food park
//#######################################################


//########################################################################################
//condicional do formulário
//sim
var condparksim = document.getElementById('condparksim');
condparksim.addEventListener('click', function(){
    document.getElementById('formparknao').style.display = 'none';
    document.getElementById('formparksim').style.display = 'block';

});
//listando parks
var listaparks = document.getElementById('listaparks');
firebase.database().ref('/Parks/').on("child_added", function(child) {
firebase.database().ref('/Parks/'+ child.key +'/perfil/').once("value", function(banco) {
var span = document.createElement('span');
span.innerHTML = (
    '<div class="col-md-12"><input id="'+ banco.val().nome +'" type="radio" name="escolhaParks" value="'+ banco.val().nome +'" >' +
    '<label for="'+ banco.val().nome +'" class="teste"><img src="'+ banco.val().foto +'" height="100px" width="100px"><span> '+ banco.val().nome +'</span></label></div>'
    );
listaparks.appendChild(span);
})
})
//parkcadastro
var condparkcadastro = document.getElementById('condparkcadastro');
   condparkcadastro.addEventListener('click', function(){
        document.getElementById('divlistaparks').style.display = 'none';
        document.getElementById('formparkcadastro').style.display = 'block';
   })
//não
var condparknao = document.getElementById('condparknao');
condparknao.addEventListener('click', function(){
    document.getElementById('formparknao').style.display = 'block';
    document.getElementById('formparksim').style.display = 'none';
});//fim não


//mensagem status
var mensagemErro = document.getElementById('mensagemErro');
 //formulario
 var formulario = document.getElementById('formulario');
//mensagem para deslogados
var avisologado = document.getElementById('avisodeslogado').value;


//vericando usuario
firebase.auth().onAuthStateChanged(user => {

    if(user){
        
        //vendo se usuario ja enviou formulario alguma vez
        firebase.database().ref('/usuarios/'+ user.uid).once("value", function(dados) {


            if (dados.val().envioCadastro == 'sim' && user.uid !== 'PQRf71AWt0TXPpwuxzHgn9JpO9m2') {
                avisodeslogado.innerHTML = (
                    '<div class="col-md-4"></div><div class="col-md-4 shadow text-center avisocaixa">' +
                    '<div class="text-center"></div><span style="padding-top:50px;">Você já fez o cadastro, aguarde a aprovação...</span><br><br>' + 
                    '<small>Você será redirecionado após 5 segundos...</small><br><br>' +
                    '<a href="../index.html">&larr; Página inicial</a></div></div>'
                    );
                    document.getElementById("avisocaixa").style.marginTop = "60px";
                    document.getElementById("avisocaixa").style.marginBottom = "60px";
                    setTimeout("window.history.go(-1)",5000);
            } else {
                document.getElementById('avisocaixa').style.display = 'none';
                document.getElementById('mostrarlogado').style.display = 'block';
           
        /*###########################################################################*/
        //submit formulario
        formulario.addEventListener('submit', function (e) {

            // impede o envio do form
            e.preventDefault();
            
            //carregando
            mensagemErro.innerHTML = ('<div class="animated fadeIn">Carregando... <img src="../img/load.gif"/></div>');

            //gerando um id para as imagens
            var d = new Date();
            var id = (+d.getFullYear()+''+("0"+(d.getMonth() + 1)).slice(-2)+''+("0" + d.getDate()).slice(-2)+''+ ("0" + d.getMinutes()).slice(-2)+''+("0" + d.getHours()).slice(-2)+''+d.getMilliseconds());
            console.log(id);
     
        //food truck
        var nomeTruck = document.getElementById('nomeTruck').value;
        var descTruck = document.getElementById('descTruck').value;
        var cnpjTruck = document.getElementById('cnpjTruck').value;
        var truckTel = document.getElementById('truckTel').value;
        var horaTruckabre = document.getElementById('horaTruckabre').value;
        var horaTruckfecha = document.getElementById('horaTruckfecha').value;
        var cepTruck = document.getElementById('cepTruck').value;
        var numeroTruck = document.getElementById('numeroTruck').value;
        var localTruck = document.getElementById('localTruck').value;

        //park
        var nomePark = document.getElementById('nomePark').value;
        var descPark = document.getElementById('descPark').value;
        var cepPark = document.getElementById('cepPark').value;
        var numeroPark = document.getElementById('numeroPark').value;
        var localPark = document.getElementById('localPark').value;
        var parkTel = document.getElementById('parkTel').value;
        var horaParkabre = document.getElementById('horaParkabre').value;
        var horaParkfecha = document.getElementById('horaParkfecha').value;
        var fotoTruck = document.getElementById('fotoTruck');     
        var fotoPark = document.getElementById('fotoPark'); 


            //pegando valores de radios e checkbox
       function getValor(name) {
            var valor = new Array ();
            var checado = new Array ();
            var valor = document.getElementsByName(name);
            var i, proximo, cont = 0;
            for (i=0; i<valor.length; i++) {
                if (valor[i].checked) {
                    proximo = cont;
                    checado[proximo] = null;
                    checado[cont] = valor[i].value;
                    cont++;
                }}return checado.toString();}
           
        //radios e checkboxes
        var semanaTruck = getValor('semanaTruck');
        var parkTruck = getValor('parkTruck');
        var estacPark = getValor('estacPark');
        var kids = getValor('kids');
        var semanaPark = getValor('semanaPark');
        var condparkcadastro = getValor('condparkcadastro');
        var escolhaParks = getValor('escolhaParks');

          //limpando as bordas
          document.getElementById('nomeTruck').style.borderColor = "";
          document.getElementById('descTruck').style.borderColor = "";
          document.getElementById('cnpjTruck').style.borderColor = "";
          document.getElementById('truckTel').style.borderColor = "";
          document.getElementById('fotoTruck').style.borderColor = "#fff";
          document.getElementById('nomePark').style.borderColor = "";
          document.getElementById('descPark').style.borderColor = "";
          document.getElementById('cepTruck').style.borderColor = "";
          document.getElementById('numeroTruck').style.borderColor = "";
          document.getElementById('complementoTruck').style.borderColor = "";
          document.getElementById('parkTel').style.borderColor = "";
          document.getElementById('fotoPark').style.borderColor = "#fff";
          document.getElementById('horaParkabre').style.borderColor = "";
          document.getElementById('horaParkfecha').style.borderColor = "";
          document.getElementById('cepPark').style.borderColor = "";
          document.getElementById('numeroPark').style.borderColor = "";
          document.getElementById('complementoPark').style.borderColor = "";
          document.getElementById('horaTruckabre').style.borderColor = "";
          document.getElementById('horaTruckfecha').style.borderColor = "";
          document.getElementById('semanaPark').style.borderColor = "#fff";
          document.getElementById('semanaTruck').style.borderColor = "#fff";
          document.getElementById('listaparks').style.borderColor = "#fff";

        //validação food truck primeira validação
        if (nomeTruck == '') {
            document.getElementById('nomeTruck').style.border = "thin solid red";
            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Prencha o campo nome!</span></div>');
        } 
        else if (descTruck == ''){
            document.getElementById('descTruck').style.border = "thin solid red";
            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Deixe uma descrição do seu Food Truck!</span></div>');
        }
        else if (fotoTruck.files.length == 0) {
            document.getElementById('fotoTruck').style.border = "thin solid red";
            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione uma foto do seu Food Truck!</span></div>');
        }
        else if (fotoTruck.files[0].type.indexOf("image") != 0) {
            document.getElementById('fotoTruck').style.border = "thin solid red";
            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione um arquivo de imagem (jpg ou png)!</span></div>');
        }
        else if (cnpjTruck == ''){
            document.getElementById('cnpjTruck').style.border = "thin solid red";
            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">O CNPJ é obrigatório!</span></div>');
        }
        else if (cnpjTruck.length !== 18){
            document.getElementById('cnpjTruck').style.border = "thin solid red";
            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Formato de CNPJ incorreto!</span></div>');
        }
        else{
        console.log('passou no primeiro grupo');


        /*###############################################################*/
        //com park cadastrado (sim)
        if (parkTruck == 'sim' && condparkcadastro == '' ) {
            console.log('entrou na validação do sim');
            if (escolhaParks == '') {
                document.getElementById('listaparks').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Selecione o Food Park!</span></div>');
            } else {
                console.log('envio do sim');
                console.log(escolhaParks);

                 //foto truck
                var fotoTruck = document.querySelector('#fotoTruck').files[0]
                var name = fotoTruck.name;
                var metadatafotoTruck = {contentType: fotoTruck.type};
                var taskfotoTruck = firebase.storage().ref('/uploads/enviados/' + user.uid + '/' + id + name).put(fotoTruck, metadatafotoTruck);
                taskfotoTruck.then((snapshot) => {
                    var urlfotoTruck = snapshot.downloadURL;
                    console.log('urlfotoTruck aqui: ' + urlfotoTruck);
                    firebase.database().ref('/enviados/truckscomPark/' + user.uid).update({
                        truckFoto: urlfotoTruck 
                        })
                        .then(function(){
                            //enviando para o firebase
                            console.log('enviou dados para o firebase');
                            
                            firebase.database().ref('/enviados/truckscomPark/' + user.uid).update ({
                                park: escolhaParks,
                                nome: user.displayName,
                                email: user.email,
                                uid: user.uid,
                                truckNome: nomeTruck,
                                truckDescricao: descTruck,
                                cnpj: cnpjTruck,
                                truckTel : truckTel
                                });

                        })//salvando envio de cadastro no usuario
                        .then(function(){
                            firebase.database().ref('/usuarios/' + user.uid).update ({
                                envioCadastro: 'sim'
                            })
                        })
                         //mensagem de sucesso
                        .then(function () {
                            console.log('sucesso');
                            avisodeslogado.innerHTML = (
                            '<div class="col-md-4"></div><div class="col-md-4 shadow text-center avisocaixa">' +
                            '<div class="text-center"></div><span style="padding-top:50px;">Enviado com sucesso :-)</span><br><br>' + 
                            '<small>Você será redirecionado apos 3 segundos...</small><br><br>' +
                            '<a href="../index.html">&larr; Página inicial</a></div></div>'
                            );
                            document.getElementById("avisocaixa").style.marginTop = "50px";
                            document.getElementById("avisocaixa").style.marginBottom = "50px";
                            document.getElementById('avisocaixa').style.display = 'block';
                            document.getElementById('mostrarlogado').style.display = 'none';
                            setTimeout("window.history.go(-1)", 3000);
                            })
                         }).catch(function (error) {
                            //limpando mensagem
                            mensagemErro.innerHTML = ('');
                            //exibindo erro 
                            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Falha ao carregar imagem!</span></div>');
                            console.log('Erro imgtruck: ' + error.message);
                    });

            }//fim else sim
        }//fim if sim
        /*################################################################*/
        //cadastro de park
        if (condparkcadastro == 'true') {
            console.log('entrou na validação do cadastro de park');
            //validação food truck
            if (nomePark == '') {
                document.getElementById('nomePark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Digite o nome do Food Park!</span></div>');
            } 
            else if (descPark == ''){
                document.getElementById('descPark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Deixe uma descrição do Food Park!</span></div>');
            }
            else if (fotoPark == fotoTruck) {
                document.getElementById('fotoPark').style.border = "thin solid red";
                document.getElementById('fotoTruck').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Foto do Food Truck igual a do Food Park!</span></div>');
            }
            else if (fotoPark.files.length == 0) {
                document.getElementById('fotoPark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione uma foto do Food Park!</span></div>');
            }
            else if (fotoPark.files[0].type.indexOf("image") != 0) {
                document.getElementById('fotoPark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione um arquivo de imagem (jpg ou png)!</span></div>');
            }
            else if (cepPark == ''){
                document.getElementById('cepPark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Digite o CEP!</span></div>');
            }
            else if (numeroPark == ''){
                document.getElementById('numeroPark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Digite o numero!</span></div>');
            }
            else if (semanaPark == ''){
                document.getElementById('semanaPark').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Escolha pelo menos um dia da semana!</span></div>');
            }
            else if (horaParkabre == ''){
                document.getElementById('horaParkabre').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione o horario de abertura!</span></div>');
            }
            else if (horaParkfecha == ''){
                document.getElementById('horaParkfecha').style.border = "thin solid red";
                mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione o horario de fechamento!</span></div>');
            }
            else {
            
        console.log('envio do cadastro do park');
            
                
               //foto truck
               var fotoTruck = document.querySelector('#fotoTruck').files[0]
                var name = fotoTruck.name;
                var metadatafotoTruck = {contentType: fotoTruck.type};
                var taskfotoTruck = firebase.storage().ref('/uploads/enviados/' + user.uid + '/' + id + name).put(fotoTruck, metadatafotoTruck);
                taskfotoTruck.then((snapshot) => {
                    var urlfotoTruck = snapshot.downloadURL;
                    console.log('urlfotoTruck aqui: ' + urlfotoTruck);
                    firebase.database().ref('/enviados/parks/' + user.uid).update({
                        truckFoto: urlfotoTruck 
                        })
                        .then(function(){
                            console.log('envio foto do park');
                            //foto do park
                            var fotoPark = document.querySelector('#fotoPark').files[0]
                            var name = fotoPark.name;
                            var metadatafotoPark = {contentType: fotoPark.type};
                            var taskfotoPark = firebase.storage().ref('/uploads/enviados/' + user.uid + '/' + id + name).put(fotoPark, metadatafotoPark);
                            taskfotoPark.then((snapshot) => {
                                var urlfotoPark = snapshot.downloadURL;
                                console.log('urlfotoPark aqui: ' + urlfotoPark);
                                firebase.database().ref('/enviados/parks/' + user.uid).update({
                                    parkFoto: urlfotoPark 
                                    })
                                })
                                //salvando envio de cadastro no usuario
                                .then(function(){
                                    console.log('envio dados usuario');
                                    firebase.database().ref('/usuarios/' + user.uid).update ({
                                        envioCadastro: 'sim'
                                    })
                                })
                            //mensagem de sucesso
                            .then(function () {
                                console.log('sucesso');
                            avisodeslogado.innerHTML = (
                            '<div class="col-md-4"></div><div class="col-md-4 shadow text-center avisocaixa">' +
                            '<div class="text-center"></div><span style="padding-top:50px;">Enviado com sucesso :-)</span><br><br>' + 
                            '<small>Você será redirecionado após 3 segundos...</small><br><br>' +
                            '<a href="../index.html">&larr; Página inicial</a></div></div>'
                            );
                            document.getElementById("avisocaixa").style.marginTop = "50px";
                            document.getElementById("avisocaixa").style.marginBottom = "50px";
                            document.getElementById('avisocaixa').style.display = 'block';
                            document.getElementById('mostrarlogado').style.display = 'none';
                            setTimeout("window.history.go(-1)", 3000);
                            })
                            })
                        .then(function(){
                            //enviando para o firebase
                            console.log('enviou dados para o firebase');
                            firebase.database().ref('/enviados/parks/' + user.uid).update( {        
                                nome: user.displayName,
                                email: user.email,
                                uid: user.uid,
                                truckNome: nomeTruck,
                                truckDescricao: descTruck,
                                truckTel : truckTel,
                                cnpj: cnpjTruck,
                                parkNome: nomePark,
                                parkDescricao: descPark,
                                parkTel : parkTel,
                                parkLocal: localPark,
                                parkEstac: estacPark,
                                areaCriancas: kids,
                                parkSemana: semanaPark,
                                parkHorario: horaParkabre + ' às ' + horaParkfecha
                            });

                        })//enviando LatLng
                            .then(function () {
                                var localMapsPark = document.getElementById('localMapsPark').value;
                                var enderecoLatLng = 'https://maps.googleapis.com/maps/api/geocode/json?address='+localMapsPark+'&key=AIzaSyDRSnBwUm4cvuJbTcCUBEL4K7Yd-4_uIo4';
                                $.ajax({
                                    url: enderecoLatLng,
                                    complete: function(res){
                                        meuJSON = JSON.parse(res.responseText);
                                        firebase.database().ref('/enviados/parks/' + user.uid).update( {
                                            lat: meuJSON.results[0].geometry.location.lat,
                                            lng: meuJSON.results[0].geometry.location.lng
                                        }).then(function () {
                                            console.log('enviou latitude e longitude');
                                        })
                                    }  
                                })
                            })
                    }).catch(function (error) {
                        //limpando mensagem
                        mensagemErro.innerHTML = ('');
                        //exibindo erro 
                        mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Falha ao carregar imagem!</span></div>');
                        console.log('Erro imgtruck: ' + error.message);
                        });

            } //fim else com park 

        }//fim if com park


            //############################
            //se não estiver em um park
            if (parkTruck == 'nao') {
                console.log('entrou na validação do não');

                if (cepTruck == ''){
                    document.getElementById('cepTruck').style.border = "thin solid red";
                    mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Digite o CEP!</span></div>');
                }
                else if (numeroTruck == ''){
                    document.getElementById('numeroTruck').style.border = "thin solid red";
                    mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Digite o numero!</span></div>');
                }
                else if (semanaTruck == ''){
                    document.getElementById('semanaTruck').style.border = "thin solid red";
                    mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Escolha pelo menos um dia da semana!</span></div>');
                }
                else if (horaTruckabre == ''){
                    document.getElementById('horaTruckabre').style.border = "thin solid red";
                    mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione o horario de abertura!</span></div>');
                }
                else if (horaTruckfecha == ''){
                    document.getElementById('horaTruckfecha').style.border = "thin solid red";
                    mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Adicione o horario de fechamento!</span></div>');
                }
                else{
                    console.log('envio do não');

                //foto truck
                var fotoTruck = document.querySelector('#fotoTruck').files[0]
                var name = fotoTruck.name;
                var metadatafotoTruck = {contentType: fotoTruck.type};
                var taskfotoTruck = firebase.storage().ref('/uploads/enviados/' + user.uid + '/' + id + name).put(fotoTruck, metadatafotoTruck);
                taskfotoTruck.then((snapshot) => {
                    var urlfotoTruck = snapshot.downloadURL;
                    console.log('urlfotoTruck aqui: ' + urlfotoTruck);
                    firebase.database().ref('/enviados/foodTrucks/' + user.uid).update({
                        truckFoto: urlfotoTruck 
                        })
                        .then(function(){
                            //enviando para o firebase
                            console.log('enviou dados para o firebase');
                            
                            firebase.database().ref('/enviados/foodTrucks/' + user.uid).update ({
                                nome: user.displayName,
                                email: user.email,
                                uid: user.uid,
                                truckNome: nomeTruck,
                                truckDescricao: descTruck,
                                cnpj: cnpjTruck,
                                truckTel : truckTel,
                                truckLocal: localTruck,
                                truckSemana: semanaTruck,
                                truckHorario:  horaTruckabre + ' às ' + horaTruckfecha
                                });

                        })//enviando LatLng
                        .then(function () {
                            var localMapsTruck = document.getElementById('localMapsTruck').value;
                            var enderecoLatLng = 'https://maps.googleapis.com/maps/api/geocode/json?address='+localMapsTruck+'&key=AIzaSyDRSnBwUm4cvuJbTcCUBEL4K7Yd-4_uIo4';
                            $.ajax({
                                url: enderecoLatLng,
                                complete: function(res){
                                    console.log('envio de LatLng');
                                    meuJSON = JSON.parse(res.responseText);
                                    firebase.database().ref('/enviados/foodTrucks/' + user.uid).update( {
                                        lat: meuJSON.results[0].geometry.location.lat,
                                        lng: meuJSON.results[0].geometry.location.lng
                                    })//mensagem de sucesso
                                        .then(function () {
                                            console.log('sucesso');
                                            avisodeslogado.innerHTML = (
                                            '<div class="col-md-4"></div><div class="col-md-4 shadow text-center avisocaixa">' +
                                            '<div class="text-center"></div><span style="padding-top:50px;">Enviado com sucesso :-)</span><br><br>' + 
                                            '<small>Você será redirecionado apos 3 segundos...</small><br><br>' +
                                            '<a href="../index.html">&larr; Página inicial</a></div></div>'
                                            );
                                            document.getElementById("avisocaixa").style.marginTop = "50px";
                                            document.getElementById("avisocaixa").style.marginBottom = "50px";
                                            document.getElementById('avisocaixa').style.display = 'block';
                                            document.getElementById('mostrarlogado').style.display = 'none';
                                            setTimeout("window.history.go(-1)", 3000);
                                            })
                                }//fim ajax  
                            })
                        })
                        //salvando envio de cadastro no usuario
                        .then(function(){
                            console.log('envio dados usuario');
                                    firebase.database().ref('/usuarios/' + user.uid).update ({
                                        envioCadastro: 'sim'
                                    })
                                })
                        }).catch(function (error) {
                            //limpando mensagem
                            mensagemErro.innerHTML = ('');
                            //exibindo erro 
                            mensagemErro.innerHTML = ('<div class="alert alert-danger"><span class="animated flash">Falha ao carregar imagem!</span></div>');
                            console.log('Erro imgtruck: ' + error.message);
                            });

                }//fim else nao

            }//fim if com nao
      
        
    
    // Limpando formulario
// document.getElementById('formulario').reset();

        }//fim else validação maior
      
});//fim submit
 }//fim else user 
})//fim envioCadastro
}//fim if user

//mensagem deslogados
else{
    console.log('não logado');
    avisodeslogado.innerHTML = (
        '<div class="col-md-4"></div><div class="col-md-4 shadow text-center avisocaixa">' +
        '<div class="text-center"></div><span style="padding-top:50px;">Para adicionar um Food Truck você precisa estar conectado.</span><br><br>' + 
        '<a href="../app/login.html" style="margin-right: 10px;"><span class="btn btn-danger my-2 my-sm-0">Entrar</span></a>' +
        '<a href="../app/cadastro.html"><span class="btn btn-danger my-2 my-sm-0">Cadastro</span></a><br><br>' +
        '<a href="../index.html">&larr; Página inicial</a></div></div>'
    );
    document.getElementById("avisocaixa").style.marginTop = "50px";
    document.getElementById("avisocaixa").style.marginBottom = "50px";
}
});//fim user
</script>

</body>
</html>